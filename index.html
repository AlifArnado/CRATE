<html>
  <head>
    <title>CRATE</title>
    <link rel="icon" type="image/png" href="./img/crateicon.png" />
    <link rel="stylesheet"
          href="./bower_components/font-awesome/css/font-awesome.min.css" />
    <link rel="stylesheet"
          href="./bower_components/bootstrap/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet"
          href="./bower_components/bootstrap/dist/css/bootstrap-theme.min.css"
          />
    <link rel="stylesheet" href="./css/generatedstyle.css"/>
  </head>
  
  <body>
    <header>
      <div id="top-header">
        <div class="container" style="width: inherit">          
          <div class="text-center" style="display:inline">
            <a id="homeIcon" href="#" class="crate-icon"
               data-trigger="hover"
               data-toggle="popover" data-placement="bottom" data-html="true"
               title="" data-content="" style="color:black">
              <span id="version" class="badge version-badge"></span>
            </a>
            <div id="menu-left-header" class="pull-right">
            </div>
          </div>
        </div>
      </div>
    </header>

    <section class="main">
      <div id="documents"></div>
    </section>
    
    
    <section>
      <div id="features"></div>
    </section>
    
    <div class="modal fade" id="modalNetwork" tabindex="-1" role="dialog"
         aria-labelledby="modelNetworkLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close">
              <span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Network's settings</h4>
          </div>
          <div class="modal-body">
            <p>
              Shared address:
              <div class="input-group">
                <span class="input-group-addon" id="configAddress"></span>
                <input type="text"
                       id="configName" class="form-control"
                       placeholder="" aria-describedby="ariaNameAddress"/>
              </div>
            </p>
            <p>
              Duration of sharing access:
              <input id="configDuration" data-slider-id="configDurationSlider"
                     type="text"
                     data-slider-min="30000" data-slider-max="600000"
                     data-slider-step="1000" data-slider-value="60000"/>
            </p>
          </div>
          <div class="modal-footer">
            <button type="button"
                    class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="saveNetworkSettings" type="button"
                    class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>
    
    <script src="./bower_components/jquery/dist/jquery.min.js"></script>
    <script src="./bower_components/bootstrap/dist/js/bootstrap.min.js">
    </script>
    <script src="./bower_components/zeroclipboard/dist/ZeroClipboard.js">
    </script>
       
    <script src="./bower_components/jquery-crate/build/jquery-crate.bundle.debug.js">
    </script>      
    <script src="./js/view/version.js"></script>
    <script src="./js/view/roundbutton.js"></script>
    <script src="./js/view/documents.js"></script>
    <script src="./js/controller/adddocument.js"></script>
    <script src="./js/view/modaladddocument.js"></script>
    <script src="./js/view/features.js"></script>
    <script src="./js/model/model.js"></script>
    
    <script>
      var peerConnectionConfig;
      
      $.ajax({
        type: "POST",
        url: "https://api.xirsys.com/getIceServers",
        data: {
          ident: "chatwane",
          secret: "8105d907-564a-4213-8c91-21b0a2f7344b",
          domain: "www.crate.com",
          application: "crate",
          room: "default",
          secure: 1
        },
        success: function (data, status) {
          // data.d is where the iceServers object lives
          var object = JSON.parse(data);
          connectionOptions = object.d;
          initialize(connectionOptions);
        },
        async: true
      });
    </script>

    <script>
      var m = new Model();
      
      var vv = new VersionView(m.version, $("#version"), $("#homeIcon"));
      var vd = new Documents($("#documents"));
      var vf = new Features(m.features, $("#features"));
      var vad = new RoundButton($("#menu-left-header"), 
                                "<i class='fa fa-plus'></i>");
      var vmad = new ModalAddDocument($("body"));
      
      var cad = new AddDocument(vad, vmad, vd);
     
      var session = null;
      if ((document.URL.split("?")).length>1){
        session = document.URL.split("?")[1];
      };
      
      function initialize(connectionOptions){
        cad.connectionOptions = connectionOptions;
      };
      
      $(function(){ $('[data-toggle="popover"]').popover(); });
    </script>
     
  </body>
</html>
